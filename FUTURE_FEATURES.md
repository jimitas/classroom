# 今後の開発予定機能

**最終更新**: 2025年12月27日

---

## 優先度：高

### 1. 招待承諾状況の確認機能

**概要**:
- 送信した招待を誰が承諾したか/していないかを確認
- 未承諾者リストを自動生成

**実装案**:
- `Classroom.Invitations.list()` APIで招待状況を取得
- スプレッドシート「招待状況」シートに結果を出力
- 承諾済み/未承諾/期限切れを色分け表示

**想定される利点**:
- 生徒・教員の参加状況を可視化
- 未承諾者への催促が容易
- 年度初めの準備状況を把握

---

### 2. 招待の再送信機能

**概要**:
- 承諾していない生徒・教員に再度招待を送信
- 個別またはクラス単位で再送信可能

**実装案**:
- 未承諾者リストを基に再送信
- 重複招待を防ぐチェック機能
- 再送信履歴をログに記録

**想定される利点**:
- 手動で1人ずつ再招待する手間を削減
- 承諾率の向上

---

## 優先度：中

### 3. メンバーの一括削除機能

**概要**:
- 間違って登録した生徒・教員を一括削除
- クラス整理・年度末の一括削除に対応

**実装案**:
- `Classroom.Courses.Students.delete()` APIを使用
- スプレッドシートで削除対象を○マークで指定
- DRY_RUNモードで事前確認

**想定される利用シーン**:
- 間違ったクラスに登録してしまった場合
- 転校・退学による削除
- 年度末のクラス整理

---

### 4. クラス設定の一括更新機能

**概要**:
- クラス名・説明文・設定を一括更新
- クラスマスタからの情報反映

**実装案**:
- `Classroom.Courses.update()` APIを使用
- スプレッドシートで更新内容を管理
- Phase 1のアーカイブと同様の処理フロー

**想定される利用シーン**:
- クラス説明文の統一
- 設定変更の一括適用
- クラス名の修正

---

## 優先度：低

### 5. 処理状況レポート生成機能

**概要**:
- 招待状況・エラー統計を自動集計
- グラフ・チャート付きレポート

**実装案**:
- 「登録処理ログ」シートを分析
- Google Chartsでビジュアル化
- 週次/月次レポート自動生成

**想定される利点**:
- 管理者による進捗把握
- DX部門への報告資料作成

---

## リファクタリング提案（2025年12月28日追加）

### 提案A: DRY-RUNモードチェックの共通化【優先度: 中】

**現状の問題**:
- Phase 1～4で同じDRY-RUNモードのチェックとログ出力が重複している
- 各Phaseで約10行の同一コードが繰り返されている

**改善案**:
- `utils/common.gs`に共通関数`setupPhaseExecution(phaseName)`を作成
- 各Phaseでこの関数を呼び出すだけにする

**効果**:
- 約40行のコード削減
- DRY-RUNモード仕様変更時の修正が1箇所で済む
- 新しいPhase追加時のコピペミスを防止

**バグリスク**: 低（現状でも問題ないが、将来的な保守性向上）

---

### 提案B: ログ記録のヘルパー関数化【優先度: 中】

**現状の問題**:
- 各PhaseでlogToProcessLog()の呼び出しパターンが似ているが微妙に異なる
- ログフォーマットの一貫性が保ちにくい

**改善案**:
- `utils/logger.gs`にヘルパー関数`logPhaseResult()`を追加
- ログ記録のフォーマットを標準化

**効果**:
- ログ記録の一貫性向上
- タイポ防止
- ログフォーマット変更時の修正が容易

**バグリスク**: 非常に低（主にコードの見通しと一貫性の問題）

---

### 提案C: マジックナンバーの定数化【優先度: 低】

**現状の問題**:
- `data_transformer.gs`で列番号（0, 1, 2, 3）がハードコードされている
- 列構造が変更された際に複数箇所を修正する必要がある

**改善案**:
- `config.gs`に`COLUMN_INDEXES`オブジェクトを追加
- 列番号を定数化（例: `COLUMN_INDEXES.ENROLLMENT.STUDENT_NAME`）

**効果**:
- 可読性向上
- 列構造変更への対応が容易
- コードの自己文書化

---

### 提案D: デバッグ用ハードコードIDの設定化【優先度: 低】

**現状の問題**:
- `debug_tools.gs`にクラスID `"823999925372"` がハードコードされている
- 環境ごとにコードを書き換える必要がある

**改善案**:
- システム設定シートに「テスト用クラスID」を追加
- `getSystemSetting()`で読み込む

**効果**:
- 環境依存を排除
- テスト用クラスの変更が容易

---

## 技術的な検討事項

### タイムアウト対策の強化

**現状**: 30分の実行時間制限内で処理可能

**将来的な拡張**:
- PropertiesServiceによるチェックポイント保存
- バッチ処理の実装
- 自動再開機能

### エラー処理の改善

**検討項目**:
- リトライ戦略の最適化
- エラー分類の詳細化
- 自動復旧機能

---

## 開発優先順位の判断基準

1. **ユーザーからの要望**: 実際の運用で必要性が高い機能
2. **実装コスト**: 開発時間と複雑さ
3. **運用効率への影響**: 時間短縮・エラー削減の効果

---

## 参考リンク

- [Google Classroom API Reference](https://developers.google.com/classroom/reference/rest)
- [DEVELOPMENT.md](./DEVELOPMENT.md) - 開発ログ
- [README.md](./README.md) - 現在の機能説明
